<templates id="template" xml:space="preserve">

    <!--
        Widget PortalChatter, and subtemplates
    -->

    <t t-extend="portal.chatter_messages">
        <t t-jquery=".o_portal_chatter_attachments" t-operation="prepend">
            <style>
                .o_portal_chatter_attachments .row:not(.row__custom) .col-lg-2:has([data-mimetype*="image"]) {
                    display: none;
                }
                .button-box {
                    display: flex;
                    align-items: center;
                    justify-content: center;
                    position: absolute;
                    top: 0;
                    background-color: rgba(0,0,0,0.8);
                    height: 100%;
                    width: 64px;
                    cursor: pointer;
                    color: #fff;
                }
                .button-box span {
                    opacity: 0.5;
                }
                .button-box-prev {
                    left: -4px;
                }
                .button-box-next {
                    right: -4px;
                }
                .rs-close {
                    position: absolute;
                    right: 8px;
                    top: 4px;
                    color: #fff;
                    z-index: 10;
                }
            </style>
            <div t-if="message.attachment_ids.length" class="row row__custom" style="padding: 8px 0;display:flex;flex-direction:row;flex-wrap:wrap;flex: 0 0 auto;">
                <div t-foreach="message.attachment_ids" t-as="item" class="col-lg-2 col-md-3 col-sm-12" t-if="['image/jpeg', 'image/png', 'image/gif'].includes(item.mimetype)">
                    <a t-attf-href="/web/content/#{item.id}?download=false&amp;access_token=#{item.access_token}" t-att-title="item.name" class="mx-1 rs-image">
                        <img t-if="['image/jpeg', 'image/png', 'image/gif'].includes(item.mimetype)" t-attf-src="/web/content/#{item.id}?download=false&amp;access_token=#{item.access_token}" t-att-title="item.name" style="width:100%;margin:4px 0;"/>
                        <div class='o_portal_chatter_attachment_name text-center'><t t-esc='item.name'/></div>
                    </a>
                </div>
            </div>
           <div class="modal fade" id="image-modal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true" data-rscurrentid="0">
              <div class="modal-dialog modal-dialog-centered">
                <div class="modal-content" style="background-color:transparent;">
                  <div class="modal-body" style="text-align:center;position:relative;padding:0;">
                    <button type="button" class="close rs-close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&amp;times;</span>
                    </button>
                    <img id="modal-image" src="" style="max-width:100%;width:100%;"/>
                      <div class="button-box button-box-prev" onclick="prevImage()">
                          <span>←</span>
                      </div>
                      <div class="button-box button-box-next" onclick="nextImage()">
                          <span>→</span>
                      </div>
                  </div>
                </div>
              </div>
           </div>
        </t>
    </t>

</templates>
